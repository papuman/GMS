<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <!-- Bulk Assign CIIU Code Wizard Form -->
    <record id="view_ciiu_bulk_assign_form" model="ir.ui.view">
        <field name="name">l10n_cr.ciiu.bulk.assign.form</field>
        <field name="model">l10n_cr.ciiu.bulk.assign</field>
        <field name="arch" type="xml">
            <form string="Bulk Assign Economic Activity">
                <sheet>
                    <div class="alert alert-info" role="alert">
                        <p><strong>Bulk Assignment Tool</strong></p>
                        <p>Assign CIIU economic activity codes to multiple partners at once.
                           This is useful for populating missing economic activity codes before the
                           <strong>October 6, 2025 deadline</strong>.</p>
                    </div>

                    <group>
                        <group string="Select CIIU Code">
                            <field name="ciiu_code_id"
                                   options="{'no_create': True}"/>
                        </group>
                        <group string="Filter Partners">
                            <field name="filter_mode" widget="radio"/>
                            <field name="country_filter"/>
                        </group>
                    </group>

                    <group attrs="{'invisible': [('filter_mode', '!=', 'category')]}">
                        <group>
                            <field name="category_id"
                                   attrs="{'required': [('filter_mode', '=', 'category')]}"/>
                        </group>
                    </group>

                    <group attrs="{'invisible': [('filter_mode', '!=', 'selected')]}">
                        <group>
                            <field name="partner_ids" widget="many2many_tags"
                                   attrs="{'required': [('filter_mode', '=', 'selected')]}"/>
                        </group>
                    </group>

                    <group>
                        <group>
                            <field name="partner_count" readonly="1"/>
                        </group>
                    </group>

                    <notebook>
                        <page string="Preview Partners" attrs="{'invisible': [('partner_count', '=', 0)]}">
                            <field name="preview_partner_ids" mode="tree">
                                <tree string="Partners to Update" create="false" delete="false">
                                    <field name="name"/>
                                    <field name="vat"/>
                                    <field name="category_id" widget="many2many_tags"/>
                                    <field name="l10n_cr_economic_activity_id"/>
                                </tree>
                            </field>
                        </page>
                    </notebook>
                </sheet>
                <footer>
                    <button name="action_assign"
                            string="Assign to Partners"
                            type="object"
                            class="btn-primary"
                            attrs="{'invisible': [('partner_count', '=', 0)]}"/>
                    <button name="action_preview"
                            string="Preview Partners"
                            type="object"
                            class="btn-secondary"/>
                    <button string="Cancel" class="btn-secondary" special="cancel"/>
                </footer>
            </form>
        </field>
    </record>

    <!-- Bulk Assign Action -->
    <record id="action_ciiu_bulk_assign" model="ir.actions.act_window">
        <field name="name">Bulk Assign Economic Activity</field>
        <field name="res_model">l10n_cr.ciiu.bulk.assign</field>
        <field name="view_mode">form</field>
        <field name="target">new</field>
        <field name="context">{}</field>
    </record>

    <!-- Quick Assign Actions -->
    <record id="action_quick_assign_gym" model="ir.actions.server">
        <field name="name">Assign 9311 (Gyms)</field>
        <field name="model_id" ref="model_l10n_cr_ciiu_bulk_assign"/>
        <field name="state">code</field>
        <field name="code">action = model.action_quick_assign_gym()</field>
    </record>

    <record id="action_quick_assign_restaurant" model="ir.actions.server">
        <field name="name">Assign 5610 (Restaurants)</field>
        <field name="model_id" ref="model_l10n_cr_ciiu_bulk_assign"/>
        <field name="state">code</field>
        <field name="code">action = model.action_quick_assign_restaurant()</field>
    </record>

    <record id="action_quick_assign_retail" model="ir.actions.server">
        <field name="name">Assign 4711 (Retail)</field>
        <field name="model_id" ref="model_l10n_cr_ciiu_bulk_assign"/>
        <field name="state">code</field>
        <field name="code">action = model.action_quick_assign_retail()</field>
    </record>

    <record id="action_quick_assign_software" model="ir.actions.server">
        <field name="name">Assign 6201 (Software)</field>
        <field name="model_id" ref="model_l10n_cr_ciiu_bulk_assign"/>
        <field name="state">code</field>
        <field name="code">action = model.action_quick_assign_software()</field>
    </record>

    <!-- Menu Items -->
    <menuitem id="menu_ciiu_bulk_assign"
              name="Bulk Assign Economic Activity"
              parent="hacienda_menu"
              action="action_ciiu_bulk_assign"
              sequence="20"/>

    <menuitem id="menu_ciiu_quick_assign"
              name="Quick Assign Templates"
              parent="hacienda_menu"
              sequence="21"/>

    <menuitem id="menu_quick_assign_gym"
              name="Gyms (9311)"
              parent="menu_ciiu_quick_assign"
              action="action_quick_assign_gym"
              sequence="1"/>

    <menuitem id="menu_quick_assign_restaurant"
              name="Restaurants (5610)"
              parent="menu_ciiu_quick_assign"
              action="action_quick_assign_restaurant"
              sequence="2"/>

    <menuitem id="menu_quick_assign_retail"
              name="Retail (4711)"
              parent="menu_ciiu_quick_assign"
              action="action_quick_assign_retail"
              sequence="3"/>

    <menuitem id="menu_quick_assign_software"
              name="Software (6201)"
              parent="menu_ciiu_quick_assign"
              action="action_quick_assign_software"
              sequence="4"/>

</odoo>
